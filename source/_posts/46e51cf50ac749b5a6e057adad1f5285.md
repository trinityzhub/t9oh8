---
layout: post
title: "How China Used a Tiny Chip in a Hack That Infiltrated Amazon and Apple :
  r/programming"
abbrlink: 46e51cf50ac749b5a6e057adad1f5285
tags: []
categories:
  - H8_T9OH8_Gen
  - artcles
  - country
  - china
  - hack_china
  - state-sponsered-hack
  - chip
date: 1727689997000
updated: 1727689997000
---

I smell some real bullshit in this article:

> Nested on the servers’ motherboards, the testers found a tiny microchip, not much bigger than a grain of rice, that wasn’t part of the boards’ original design. Amazon reported the discovery to U.S. authorities, sending a shudder through the intelligence community.

And then:

> This system could let the attackers alter how the device functioned, line by line, however they wanted, leaving no one the wiser. To understand the power that would give them, take this hypothetical example: Somewhere in the Linux operating system, which runs in many servers, is code that authorizes a user by verifying a typed password against a stored encrypted one. An implanted chip can alter part of that code so the server won’t check for a password—and presto! A secure machine is open to any and all users.

There is absolutely no way this can be the case. There are multiple issues with this statement, and just to mention some:

- The chip is far too small to have this kind of power. They are suggesting the chip can directly intercept both the address bus and data bus to system memory. A "rice grain sized chip" cannot do that.

- The chip is not embedded in the CPU, but the IMC and the MMU and everything else related to memory is. How can a chip sitting outside the CPU gain information sitting in the IMC and MMU when these are only accessible to the processor itself?

- Linux has KASLR and userspace ASLR, which works on top of the virtual address space, which goes through a layer (the virtual address space goes through the MMU to physical address space...), which means that it would either be incredibly hard or outright impossible for a chip sitting outside the CPU to be able to locate particular machine code used by the kernel in physical memory.

In my opinion, this magical grain sized chip is completely infeasible. Even if such a small chip to maliciously control system memory was possible (it *really* isn't), then all it sees is raw, physical memory. To be able to make sense of any of that and have even the slightest chance of interfering with system memory it needs to scan the entire physical address space and THEN correctly interpret the data in it through some magic. Anyone who's worked with physical memory in IBM compatibles knows how badly scanning the physical address space can turn out. It can completely crash a system.

Yeah, something's not right here. This chip is simply impossible. The Intel ME and the AMD PSP can do this stuff, sure, because it's actually *embedded* in the x86 processor. This, however, is simply not possible. I cannot even imagine how they would pull that off with a single chip, particularly not a "grain sized one", when so much of the information required for the chip to even work is embedded in the CPU itself and not accessible to it.

EDIT: I figured it out, I think. I somehow missed this part in the article:

> The illicit chips could do all this because they were connected to the baseboard management controller, a kind of superchip that administrators use to remotely log in to problematic servers, giving them access to the most sensitive code even on machines that have crashed or are turned off.

Either we are talking about an exploit in the BMC or a chip that actually modifies the BMC's firmware and creates a backdoor. That narrows the problem down a lot and will be helpful, but I do have bad news nonetheless. BMC vulnerabilities are [not at all uncommon](https://www.blackhat.com/us-18/briefings/schedule/index.html#the-unbearable-lightness-of-bmcs-10035). Furthermore, every other server motherboard manufacturer could just as easily have been compromised either through existing vulnerabilities or a similar chip, if this story is true.

Unfortunately, a lot of what Bloomberg wrote *before* this part is simply far less important than the actual attack vector itself. The BMC also doesn't have direct access to interfere with x86 execution or just snip out password validation from the kernel running on the host as Bloomberg wrote above. The BMC is powerful, but it can't do that, so the article is still full of bs.
